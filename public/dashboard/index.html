<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSS-Tok Advanced Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <style>
        :root {
            --radius: 0.65rem;
            --background: oklch(1 0 0);
            --foreground: oklch(0.141 0.005 285.823);
            --card: oklch(1 0 0);
            --card-foreground: oklch(0.141 0.005 285.823);
            --popover: oklch(1 0 0);
            --popover-foreground: oklch(0.141 0.005 285.823);
            --primary: oklch(0.637 0.237 25.331);
            --primary-foreground: oklch(0.971 0.013 17.38);
            --secondary: oklch(0.967 0.001 286.375);
            --secondary-foreground: oklch(0.21 0.006 285.885);
            --muted: oklch(0.967 0.001 286.375);
            --muted-foreground: oklch(0.552 0.016 285.938);
            --accent: oklch(0.967 0.001 286.375);
            --accent-foreground: oklch(0.21 0.006 285.885);
            --destructive: oklch(0.577 0.245 27.325);
            --border: oklch(0.92 0.004 286.32);
            --input: oklch(0.92 0.004 286.32);
            --ring: oklch(0.637 0.237 25.331);
            --chart-1: oklch(0.646 0.222 41.116);
            --chart-2: oklch(0.6 0.118 184.704);
            --chart-3: oklch(0.398 0.07 227.392);
            --chart-4: oklch(0.828 0.189 84.429);
            --chart-5: oklch(0.769 0.188 70.08);
            --sidebar: oklch(0.985 0 0);
            --sidebar-foreground: oklch(0.141 0.005 285.823);
            --sidebar-primary: oklch(0.637 0.237 25.331);
            --sidebar-primary-foreground: oklch(0.971 0.013 17.38);
            --sidebar-accent: oklch(0.967 0.001 286.375);
            --sidebar-accent-foreground: oklch(0.21 0.006 285.885);
            --sidebar-border: oklch(0.92 0.004 286.32);
            --sidebar-ring: oklch(0.637 0.237 25.331);
        }

        .dark {
            --background: oklch(0.141 0.005 285.823);
            --foreground: oklch(0.985 0 0);
            --card: oklch(0.21 0.006 285.885);
            --card-foreground: oklch(0.985 0 0);
            --popover: oklch(0.21 0.006 285.885);
            --popover-foreground: oklch(0.985 0 0);
            --primary: oklch(0.637 0.237 25.331);
            --primary-foreground: oklch(0.971 0.013 17.38);
            --secondary: oklch(0.274 0.006 286.033);
            --secondary-foreground: oklch(0.985 0 0);
            --muted: oklch(0.274 0.006 286.033);
            --muted-foreground: oklch(0.705 0.015 286.067);
            --accent: oklch(0.274 0.006 286.033);
            --accent-foreground: oklch(0.985 0 0);
            --destructive: oklch(0.704 0.191 22.216);
            --border: oklch(1 0 0 / 10%);
            --input: oklch(1 0 0 / 15%);
            --ring: oklch(0.637 0.237 25.331);
            --chart-1: oklch(0.488 0.243 264.376);
            --chart-2: oklch(0.696 0.17 162.48);
            --chart-3: oklch(0.769 0.188 70.08);
            --chart-4: oklch(0.627 0.265 303.9);
            --chart-5: oklch(0.645 0.246 16.439);
            --sidebar: oklch(0.21 0.006 285.885);
            --sidebar-foreground: oklch(0.985 0 0);
            --sidebar-primary: oklch(0.637 0.237 25.331);
            --sidebar-primary-foreground: oklch(0.971 0.013 17.38);
            --sidebar-accent: oklch(0.274 0.006 286.033);
            --sidebar-accent-foreground: oklch(0.985 0 0);
            --sidebar-border: oklch(1 0 0 / 10%);
            --sidebar-ring: oklch(0.637 0.237 25.331);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--foreground);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        /* Layout */
        .app-layout {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--sidebar);
            border-right: 1px solid var(--sidebar-border);
            color: var(--sidebar-foreground);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--sidebar-border);
        }

        .sidebar-header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--sidebar-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar-header p {
            font-size: 0.875rem;
            color: var(--muted-foreground);
            margin-top: 0.25rem;
        }

        .sidebar-nav {
            padding: 1rem;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--muted-foreground);
            margin-bottom: 0.75rem;
            padding: 0 0.75rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            margin-bottom: 0.25rem;
            border-radius: var(--radius);
            color: var(--sidebar-foreground);
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover {
            background: var(--sidebar-accent);
            color: var(--sidebar-accent-foreground);
        }

        .nav-item.active {
            background: var(--sidebar-primary);
            color: var(--sidebar-primary-foreground);
        }

        .nav-item i {
            width: 1.25rem;
            font-size: 1rem;
        }

        .channel-item {
            position: relative;
        }

        .channel-badge {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: var(--primary-foreground);
            font-size: 0.75rem;
            padding: 0.125rem 0.5rem;
            border-radius: 1rem;
            font-weight: 500;
            min-width: 1.5rem;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            background: var(--background);
        }

        .content-header {
            background: var(--card);
            border-bottom: 1px solid var(--border);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--card-foreground);
        }

        .content-subtitle {
            font-size: 0.875rem;
            color: var(--muted-foreground);
            margin-top: 0.25rem;
        }

        .content-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            background: var(--secondary);
            color: var(--secondary-foreground);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background: var(--accent);
            color: var(--accent-foreground);
        }

        .btn-primary {
            background: var(--primary);
            color: var(--primary-foreground);
        }

        .btn-primary:hover {
            background: var(--primary);
            opacity: 0.9;
        }

        .btn-icon {
            padding: 0.5rem;
            width: auto;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--muted);
            border-radius: var(--radius);
            font-size: 0.875rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Content Area */
        .content-body {
            padding: 2rem;
            min-height: calc(100vh - 120px);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            transition: all 0.2s ease;
        }

        .stat-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--muted-foreground);
        }

        .stat-icon {
            width: 2rem;
            height: 2rem;
            background: var(--primary);
            color: var(--primary-foreground);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--card-foreground);
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive {
            color: var(--chart-4);
        }

        .stat-change.negative {
            color: var(--destructive);
        }

        /* Content Sections */
        .content-section {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .section-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--card-foreground);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section-body {
            padding: 1.5rem;
        }

        /* Channel Grid */
        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .channel-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .channel-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .channel-card:hover::before {
            opacity: 1;
        }

        .channel-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .channel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .channel-name {
            font-weight: 600;
            font-size: 1.125rem;
            color: var(--card-foreground);
            text-transform: capitalize;
        }

        .channel-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--muted-foreground);
        }

        .channel-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .metric {
            text-align: center;
            padding: 1rem;
            background: var(--muted);
            border-radius: var(--radius);
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .metric-label {
            font-size: 0.75rem;
            color: var(--muted-foreground);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--muted);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--chart-1));
            border-radius: 4px;
            transition: width 0.8s ease;
        }

        /* Article List */
        .article-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .article-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s ease;
            cursor: pointer;
        }

        .article-item:hover {
            background: var(--muted);
        }

        .article-item:last-child {
            border-bottom: none;
        }

        .article-content {
            flex: 1;
        }

        .article-title {
            font-weight: 600;
            color: var(--card-foreground);
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .article-excerpt {
            font-size: 0.875rem;
            color: var(--muted-foreground);
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .article-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--muted-foreground);
        }

        .article-status {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            min-width: 100px;
        }

        .translation-status {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .translation-status.completed {
            background: var(--chart-4);
            color: white;
        }

        .translation-status.pending {
            background: var(--chart-5);
            color: white;
        }

        .translation-status.none {
            background: var(--muted);
            color: var(--muted-foreground);
        }

        /* Search and Filters */
        .search-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--background);
            color: var(--foreground);
            font-size: 0.875rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--ring);
        }

        .filter-select {
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background: var(--background);
            color: var(--foreground);
            font-size: 0.875rem;
            cursor: pointer;
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 1rem;
        }

        .chart-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        /* Activity Log */
        .activity-log {
            max-height: 400px;
            overflow-y: auto;
        }

        .log-entry {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s ease;
        }

        .log-entry:hover {
            background: var(--muted);
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-time {
            font-size: 0.875rem;
            color: var(--muted-foreground);
            font-family: monospace;
            white-space: nowrap;
        }

        .log-type {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .log-type.info {
            background: var(--chart-2);
            color: white;
        }

        .log-type.warning {
            background: var(--chart-5);
            color: white;
        }

        .log-type.error {
            background: var(--destructive);
            color: white;
        }

        .log-message {
            flex: 1;
            font-size: 0.875rem;
            color: var(--card-foreground);
        }

        /* Session Cards */
        .sessions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .session-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            transition: all 0.2s ease;
        }

        .session-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .session-id {
            font-family: monospace;
            font-size: 0.875rem;
            color: var(--muted-foreground);
        }

        .session-status {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .session-status.active {
            background: var(--chart-4);
            color: white;
        }

        .session-status.expired {
            background: var(--muted);
            color: var(--muted-foreground);
        }

        .session-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .session-detail {
            text-align: center;
        }

        .session-detail-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .session-detail-label {
            font-size: 0.75rem;
            color: var(--muted-foreground);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Health Status */
        .health-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .health-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            text-align: center;
        }

        .health-icon {
            width: 3rem;
            height: 3rem;
            background: var(--primary);
            color: var(--primary-foreground);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 1rem;
        }

        .health-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--card-foreground);
            margin-bottom: 0.5rem;
        }

        .health-label {
            font-size: 0.875rem;
            color: var(--muted-foreground);
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            border: 2px solid var(--muted);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--card);
            border-radius: var(--radius);
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--card-foreground);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--muted-foreground);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--muted);
            color: var(--card-foreground);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .channels-grid {
                grid-template-columns: 1fr;
            }

            .sessions-grid {
                grid-template-columns: 1fr;
            }

            .health-grid {
                grid-template-columns: 1fr;
            }

            .content-header {
                padding: 1rem;
            }

            .content-body {
                padding: 1rem;
            }

            .search-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-input {
                min-width: auto;
            }
        }

        /* Mobile menu button */
        .mobile-menu-btn {
            display: none;
            background: var(--primary);
            color: var(--primary-foreground);
            border: none;
            padding: 0.75rem;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
        }

        /* Utility Classes */
        .hidden { display: none; }
        .text-center { text-align: center; }
        .text-muted { color: var(--muted-foreground); }
        .font-mono { font-family: monospace; }
        
        /* Loading Indicator */
        .loading-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--muted-foreground);
        }

        .loading-text {
            margin-left: 0.5rem;
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            color: var(--muted-foreground);
            text-align: center;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 0.5rem;
            color: var(--card-foreground);
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1>
                    <i class="fas fa-rss"></i>
                    RSS-Tok Pro
                </h1>
                <p>Advanced RSS monitoring</p>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <a href="#" class="nav-item active" data-view="dashboard">
                        <i class="fas fa-chart-line"></i>
                        Dashboard
                    </a>
                    <a href="#" class="nav-item" data-view="analytics">
                        <i class="fas fa-chart-bar"></i>
                        Analytics
                    </a>
                    <a href="#" class="nav-item" data-view="health">
                        <i class="fas fa-heart"></i>
                        Health Status
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Content Channels</div>
                    <div id="channelNavItems">
                        <!-- Channel navigation items will be populated here -->
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">System</div>
                    <a href="#" class="nav-item" data-view="jobs">
                        <i class="fas fa-cogs"></i>
                        Background Jobs
                    </a>
                    <a href="#" class="nav-item" data-view="sessions">
                        <i class="fas fa-users"></i>
                        Active Sessions
                    </a>
                    <a href="#" class="nav-item" data-view="logs">
                        <i class="fas fa-file-alt"></i>
                        Activity Logs
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <div>
                    <h1 class="content-title" id="pageTitle">Dashboard Overview</h1>
                    <p class="content-subtitle" id="pageSubtitle">Real-time monitoring of RSS feeds and translations</p>
                </div>
                <div class="content-actions">
                    <button class="mobile-menu-btn" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <button class="btn" onclick="refreshData()" title="Refresh data">
                        <i class="fas fa-sync-alt"></i>
                        Refresh
                    </button>
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span id="lastUpdate">Loading...</span>
                    </div>
                    <button class="btn btn-icon" onclick="toggleTheme()" title="Toggle theme">
                        <i class="fas fa-moon" id="themeIcon"></i>
                    </button>
                </div>
            </header>

            <div class="content-body">
                <!-- Dashboard View -->
                <div id="dashboardView" class="view-content">
                    <!-- Stats Overview -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Total Articles</span>
                                <div class="stat-icon">
                                    <i class="fas fa-newspaper"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="totalItems">-</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="itemsChange">Loading...</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Translated Articles</span>
                                <div class="stat-icon">
                                    <i class="fas fa-language"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="translatedItems">-</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="translatedChange">Loading...</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Active Channels</span>
                                <div class="stat-icon">
                                    <i class="fas fa-broadcast-tower"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="activeChannels">-</div>
                            <div class="stat-change">
                                <i class="fas fa-check-circle"></i>
                                <span>All operational</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Active Sessions</span>
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="activeSessions">-</div>
                            <div class="stat-change" id="sessionsChange">
                                <i class="fas fa-clock"></i>
                                <span>Loading...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Channels Overview -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-broadcast-tower"></i>
                                RSS Channels
                            </h2>
                            <button class="btn" onclick="refreshChannels()" title="Refresh channels">
                                <i class="fas fa-sync-alt"></i>
                                Refresh
                            </button>
                        </div>
                        <div class="section-body">
                            <div class="channels-grid" id="channelsGrid">
                                <!-- Channels will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-history"></i>
                                Recent Activity
                            </h2>
                            <button class="btn" onclick="clearLogs()" title="Clear logs">
                                <i class="fas fa-trash"></i>
                                Clear
                            </button>
                        </div>
                        <div class="section-body">
                            <div class="activity-log" id="activityLog">
                                <!-- Activity entries will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics View -->
                <div id="analyticsView" class="view-content hidden">
                    <div class="chart-controls">
                        <select class="filter-select" id="analyticsTimeRange">
                            <option value="day">Last 24 Hours</option>
                            <option value="week" selected>Last Week</option>
                            <option value="month">Last Month</option>
                        </select>
                        <select class="filter-select" id="analyticsGranularity">
                            <option value="hour" selected>Hourly</option>
                            <option value="day">Daily</option>
                        </select>
                        <button class="btn" onclick="updateAnalytics()">
                            <i class="fas fa-sync-alt"></i>
                            Update
                        </button>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-chart-line"></i>
                                Content Creation Timeline
                            </h2>
                        </div>
                        <div class="section-body">
                            <div class="chart-container">
                                <canvas id="timelineChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-chart-pie"></i>
                                Channel Distribution
                            </h2>
                        </div>
                        <div class="section-body">
                            <div class="chart-container">
                                <canvas id="distributionChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-chart-bar"></i>
                                Translation Progress
                            </h2>
                        </div>
                        <div class="section-body">
                            <div class="chart-container">
                                <canvas id="translationChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Health View -->
                <div id="healthView" class="view-content hidden">
                    <div class="health-grid">
                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-server"></i>
                            </div>
                            <div class="health-value" id="healthUptime">-</div>
                            <div class="health-label">System Uptime</div>
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-database"></i>
                            </div>
                            <div class="health-value" id="healthDbResponse">-</div>
                            <div class="health-label">DB Response Time</div>
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-memory"></i>
                            </div>
                            <div class="health-value" id="healthMemory">-</div>
                            <div class="health-label">Memory Usage</div>
                        </div>

                        <div class="health-card">
                            <div class="health-icon">
                                <i class="fas fa-microchip"></i>
                            </div>
                            <div class="health-value" id="healthCpu">-</div>
                            <div class="health-label">CPU Usage</div>
                        </div>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-chart-line"></i>
                                Performance Metrics
                            </h2>
                        </div>
                        <div class="section-body">
                            <div class="chart-container">
                                <canvas id="performanceChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Jobs View -->
                <div id="jobsView" class="view-content hidden">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">RSS Fetch Jobs</span>
                                <div class="stat-icon">
                                    <i class="fas fa-download"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="rssFetchJobs">-</div>
                            <div class="stat-change">
                                <i class="fas fa-clock"></i>
                                <span>Every 30 minutes</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Translation Jobs</span>
                                <div class="stat-icon">
                                    <i class="fas fa-language"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="translationJobs">-</div>
                            <div class="stat-change">
                                <i class="fas fa-hourglass-half"></i>
                                <span id="translationJobsStatus">Processing...</span>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-title">Cleanup Jobs</span>
                                <div class="stat-icon">
                                    <i class="fas fa-broom"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="cleanupJobs">-</div>
                            <div class="stat-change">
                                <i class="fas fa-clock"></i>
                                <span>Every 10 minutes</span>
                            </div>
                        </div>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-cogs"></i>
                                Job Controls
                            </h2>
                        </div>
                        <div class="section-body">
                            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="triggerRssFetch()">
                                    <i class="fas fa-download"></i>
                                    Trigger RSS Fetch
                                </button>
                                <button class="btn btn-primary" onclick="triggerTranslation()">
                                    <i class="fas fa-language"></i>
                                    Check Translations
                                </button>
                                <button class="btn btn-primary" onclick="triggerCleanup()">
                                    <i class="fas fa-broom"></i>
                                    Run Cleanup
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sessions View -->
                <div id="sessionsView" class="view-content hidden">
                    <div class="search-controls">
                        <input type="text" class="search-input" placeholder="Search sessions..." id="sessionSearch">
                        <select class="filter-select" id="sessionFilter">
                            <option value="all">All Sessions</option>
                            <option value="active">Active Only</option>
                            <option value="expired">Expired Only</option>
                        </select>
                        <button class="btn" onclick="refreshSessions()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>

                    <div class="sessions-grid" id="sessionsGrid">
                        <!-- Sessions will be populated here -->
                    </div>
                </div>

                <!-- Logs View -->
                <div id="logsView" class="view-content hidden">
                    <div class="search-controls">
                        <input type="text" class="search-input" placeholder="Search logs..." id="logSearch">
                        <select class="filter-select" id="logLevelFilter">
                            <option value="all">All Levels</option>
                            <option value="error">Errors</option>
                            <option value="warning">Warnings</option>
                            <option value="info">Info</option>
                        </select>
                        <button class="btn" onclick="exportLogs()">
                            <i class="fas fa-download"></i>
                            Export
                        </button>
                        <button class="btn" onclick="clearAllLogs()">
                            <i class="fas fa-trash"></i>
                            Clear All
                        </button>
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-file-alt"></i>
                                System Logs
                            </h2>
                        </div>
                        <div class="section-body">
                            <div class="activity-log" id="systemLogs" style="max-height: 600px;">
                                <!-- System logs will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Channel Content Modal -->
    <div id="channelModal" class="modal hidden">
        <div class="modal-content" style="width: 90vw; max-width: 1000px;">
            <div class="modal-header">
                <h2 class="modal-title" id="channelModalTitle">Channel Content</h2>
                <button class="modal-close" onclick="closeChannelModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="search-controls">
                <input type="text" class="search-input" placeholder="Search articles..." id="articleSearch">
                <select class="filter-select" id="translationFilter">
                    <option value="all">All Articles</option>
                    <option value="translated">Translated</option>
                    <option value="pending">Pending Translation</option>
                    <option value="none">Not Translated</option>
                </select>
                <button class="btn" onclick="refreshChannelContent()">
                    <i class="fas fa-sync-alt"></i>
                    Refresh
                </button>
            </div>

            <div class="article-list" id="articleList">
                <!-- Articles will be populated here -->
            </div>

            <div class="loading-indicator hidden" id="articleLoading">
                <div class="spinner"></div>
                <span class="loading-text">Loading more articles...</span>
            </div>
        </div>
    </div>

    <script>
        let refreshInterval;
        let activityLog = [];
        let systemLogs = [];
        let currentChannel = null;
        let currentChannelArticles = [];
        let timelineChart = null;
        let distributionChart = null;
        let translationChart = null;
        let performanceChart = null;
        let currentSessions = [];
        const REFRESH_INTERVAL = 30000; // 30 seconds

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            initNavigation();
            initCharts();
            loadDashboard();
            startAutoRefresh();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Search functionality
            document.getElementById('articleSearch').addEventListener('input', filterArticles);
            document.getElementById('translationFilter').addEventListener('change', filterArticles);
            document.getElementById('sessionSearch').addEventListener('input', filterSessions);
            document.getElementById('sessionFilter').addEventListener('change', filterSessions);
            document.getElementById('logSearch').addEventListener('input', filterLogs);
            document.getElementById('logLevelFilter').addEventListener('change', filterLogs);
        }

        // Theme Management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.className = savedTheme;
            updateThemeIcon();
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.className;
            const newTheme = currentTheme === 'dark' ? '' : 'dark';
            document.documentElement.className = newTheme;
            localStorage.setItem('theme', newTheme || 'light');
            updateThemeIcon();
        }

        function updateThemeIcon() {
            const icon = document.getElementById('themeIcon');
            const isDark = document.documentElement.className === 'dark';
            icon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
        }

        // Navigation Management
        function initNavigation() {
            const navItems = document.querySelectorAll('.nav-item[data-view]');
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const view = item.getAttribute('data-view');
                    switchView(view);
                    
                    // Update active state
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                });
            });
        }

        function switchView(viewName) {
            // Hide all views
            document.querySelectorAll('.view-content').forEach(view => {
                view.classList.add('hidden');
            });
            
            // Show selected view
            const selectedView = document.getElementById(viewName + 'View');
            if (selectedView) {
                selectedView.classList.remove('hidden');
            }
            
            // Update page title
            updatePageTitle(viewName);
            
            // Load view-specific data
            loadViewData(viewName);
        }

        function updatePageTitle(viewName) {
            const titles = {
                dashboard: { title: 'Dashboard Overview', subtitle: 'Real-time monitoring of RSS feeds and translations' },
                analytics: { title: 'Analytics Dashboard', subtitle: 'Detailed insights and performance metrics' },
                health: { title: 'Health Status', subtitle: 'System health and performance monitoring' },
                jobs: { title: 'Background Jobs', subtitle: 'Monitor RSS fetching and translation jobs' },
                sessions: { title: 'Active Sessions', subtitle: 'User session management and analytics' },
                logs: { title: 'Activity Logs', subtitle: 'Detailed system activity and error logs' }
            };
            
            const titleInfo = titles[viewName] || titles.dashboard;
            document.getElementById('pageTitle').textContent = titleInfo.title;
            document.getElementById('pageSubtitle').textContent = titleInfo.subtitle;
        }

        function loadViewData(viewName) {
            switch(viewName) {
                case 'analytics':
                    updateAnalytics();
                    break;
                case 'health':
                    loadHealthData();
                    break;
                case 'jobs':
                    loadJobsData();
                    break;
                case 'sessions':
                    loadSessionsData();
                    break;
                case 'logs':
                    loadSystemLogs();
                    break;
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        // Chart Initialization
        function initCharts() {
            // Timeline Chart
            const timelineCtx = document.getElementById('timelineChart').getContext('2d');
            timelineChart = new Chart(timelineCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Content Creation Over Time'
                        },
                        legend: {
                            display: true,
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Distribution Chart
            const distributionCtx = document.getElementById('distributionChart').getContext('2d');
            distributionChart = new Chart(distributionCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: []
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Articles by Channel'
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Translation Chart
            const translationCtx = document.getElementById('translationChart').getContext('2d');
            translationChart = new Chart(translationCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Total Articles',
                        data: [],
                        backgroundColor: 'rgba(99, 102, 241, 0.5)',
                        borderColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Translated',
                        data: [],
                        backgroundColor: 'rgba(34, 197, 94, 0.5)',
                        borderColor: 'rgba(34, 197, 94, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Translation Progress by Channel'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(performanceCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Response Time (ms)',
                        data: [],
                        borderColor: 'rgba(99, 102, 241, 1)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'System Performance Over Time'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Data Loading Functions
        async function loadDashboard() {
            try {
                document.body.classList.add('loading');
                
                // Load all data in parallel
                const [stats, health, channels] = await Promise.all([
                    fetch('/api/rss/dashboard-stats').then(r => r.json()),
                    fetch('/health').then(r => r.json()),
                    fetch('/api/rss/channels').then(r => r.json())
                ]);

                updateStats(stats);
                updateHealth(health);
                updateChannels(channels);
                updateChannelNavigation(channels);
                
                // Load session data if API v2 is available
                try {
                    await loadSessionStats();
                } catch (error) {
                    console.warn('Session API not available:', error);
                    document.getElementById('activeSessions').textContent = 'N/A';
                    document.getElementById('sessionsChange').innerHTML = '<i class="fas fa-info-circle"></i><span>API v2 not available</span>';
                }
                
                updateLastUpdateTime();
                addActivityLog('info', 'Dashboard updated successfully');
                
            } catch (error) {
                console.error('Error loading dashboard:', error);
                addActivityLog('error', `Failed to load dashboard: ${error.message}`);
            } finally {
                document.body.classList.remove('loading');
            }
        }

        async function loadSessionStats() {
            // This would use our API v2 endpoints when available
            // For now, we'll simulate session data
            const mockSessions = Math.floor(Math.random() * 50) + 10;
            document.getElementById('activeSessions').textContent = mockSessions;
            document.getElementById('sessionsChange').innerHTML = '<i class="fas fa-users"></i><span>Active now</span>';
        }

        function updateStats(response) {
            if (response.success && response.data) {
                const data = response.data;
                
                document.getElementById('totalItems').textContent = data.totalItems || 0;
                document.getElementById('translatedItems').textContent = data.itemsWithTranslations || 0;
                
                // Calculate translation percentage
                const percentage = data.totalItems > 0 
                    ? Math.round((data.itemsWithTranslations / data.totalItems) * 100)
                    : 0;
                    
                document.getElementById('itemsChange').textContent = `${percentage}% translated`;
                document.getElementById('translatedChange').textContent = `${data.itemsWithTranslations} completed`;
            }
        }

        function updateHealth(health) {
            // Update health indicator
            if (health.status === 'healthy') {
                document.querySelector('.status-dot').style.background = 'var(--chart-4)';
            } else {
                document.querySelector('.status-dot').style.background = 'var(--destructive)';
            }
        }

        function updateChannels(response) {
            const grid = document.getElementById('channelsGrid');
            const channelCount = document.getElementById('activeChannels');
            
            if (response.success && response.data) {
                channelCount.textContent = response.data.length;
                
                grid.innerHTML = response.data.map(channel => `
                    <div class="channel-card" onclick="openChannelModal('${channel.channel}')">
                        <div class="channel-header">
                            <div class="channel-name">${channel.channel}</div>
                            <div class="channel-status">
                                <div class="status-dot"></div>
                                Active
                            </div>
                        </div>
                        
                        <div class="channel-metrics">
                            <div class="metric">
                                <div class="metric-value" id="items-${channel.channel}">-</div>
                                <div class="metric-label">Articles</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value" id="translated-${channel.channel}">-</div>
                                <div class="metric-label">Translated</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-${channel.channel}" style="width: 0%"></div>
                        </div>
                    </div>
                `).join('');

                // Load individual channel stats
                response.data.forEach(channel => {
                    loadChannelStats(channel.channel);
                });
            }
        }

        function updateChannelNavigation(response) {
            const container = document.getElementById('channelNavItems');
            
            if (response.success && response.data) {
                container.innerHTML = response.data.map(channel => `
                    <div class="nav-item channel-item" onclick="openChannelModal('${channel.channel}')">
                        <i class="fas fa-rss"></i>
                        <span>${channel.channel}</span>
                        <div class="channel-badge" id="badge-${channel.channel}">0</div>
                    </div>
                `).join('');
            }
        }

        async function loadChannelStats(channel) {
            try {
                const response = await fetch(`/api/rss/${channel}?limit=1000`);
                const data = await response.json();
                
                if (data.success) {
                    const items = data.data;
                    const total = data.pagination.total;
                    const translated = items.filter(item => item.hasTranslation).length;
                    const percentage = total > 0 ? Math.round((translated / total) * 100) : 0;
                    
                    // Update channel card
                    const itemsEl = document.getElementById(`items-${channel}`);
                    const translatedEl = document.getElementById(`translated-${channel}`);
                    const progressEl = document.getElementById(`progress-${channel}`);
                    const badgeEl = document.getElementById(`badge-${channel}`);
                    
                    if (itemsEl) itemsEl.textContent = total;
                    if (translatedEl) translatedEl.textContent = translated;
                    if (progressEl) progressEl.style.width = `${percentage}%`;
                    if (badgeEl) badgeEl.textContent = total;
                }
            } catch (error) {
                console.error(`Error loading stats for ${channel}:`, error);
            }
        }

        // Channel Modal Functions
        async function openChannelModal(channelId) {
            currentChannel = channelId;
            document.getElementById('channelModalTitle').textContent = `${channelId} - Content`;
            document.getElementById('channelModal').classList.remove('hidden');
            
            await loadChannelContent();
        }

        function closeChannelModal() {
            document.getElementById('channelModal').classList.add('hidden');
            currentChannel = null;
            currentChannelArticles = [];
        }

        async function loadChannelContent() {
            if (!currentChannel) return;
            
            try {
                document.getElementById('articleLoading').classList.remove('hidden');
                
                const response = await fetch(`/api/rss/${currentChannel}?limit=100`);
                const data = await response.json();
                
                if (data.success) {
                    currentChannelArticles = data.data;
                    displayArticles(currentChannelArticles);
                }
            } catch (error) {
                console.error('Error loading channel content:', error);
                addActivityLog('error', `Failed to load content for ${currentChannel}`);
            } finally {
                document.getElementById('articleLoading').classList.add('hidden');
            }
        }

        function displayArticles(articles) {
            const container = document.getElementById('articleList');
            
            if (articles.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-newspaper"></i>
                        <h3>No articles found</h3>
                        <p>No articles match your current filters.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = articles.map(article => `
                <div class="article-item">
                    <div class="article-content">
                        <div class="article-title">${article.title || 'No title'}</div>
                        <div class="article-excerpt">${(article.content || '').substring(0, 200)}...</div>
                        <div class="article-meta">
                            <span><i class="fas fa-calendar"></i> ${new Date(article.pubTimestamp || Date.now()).toLocaleDateString()}</span>
                            <span><i class="fas fa-link"></i> <a href="${article.link}" target="_blank">Read more</a></span>
                        </div>
                    </div>
                    <div class="article-status">
                        <div class="translation-status ${article.hasTranslation ? 'completed' : 'none'}">
                            ${article.hasTranslation ? 'Translated' : 'Not Translated'}
                        </div>
                        ${article.hasTranslation ? '' : '<button class="btn btn-primary" onclick="triggerArticleTranslation(\'' + article.itemId + '\')"><i class="fas fa-language"></i></button>'}
                    </div>
                </div>
            `).join('');
        }

        function filterArticles() {
            const searchTerm = document.getElementById('articleSearch').value.toLowerCase();
            const translationFilter = document.getElementById('translationFilter').value;
            
            let filtered = currentChannelArticles.filter(article => {
                const matchesSearch = !searchTerm || 
                    (article.title && article.title.toLowerCase().includes(searchTerm)) ||
                    (article.content && article.content.toLowerCase().includes(searchTerm));
                
                let matchesFilter = true;
                if (translationFilter === 'translated') {
                    matchesFilter = article.hasTranslation;
                } else if (translationFilter === 'pending') {
                    matchesFilter = article.translationJob && article.translationJob.status === 'processing';
                } else if (translationFilter === 'none') {
                    matchesFilter = !article.hasTranslation;
                }
                
                return matchesSearch && matchesFilter;
            });
            
            displayArticles(filtered);
        }

        async function refreshChannelContent() {
            await loadChannelContent();
        }

        // Analytics Functions
        async function updateAnalytics() {
            const timeRange = document.getElementById('analyticsTimeRange').value;
            const granularity = document.getElementById('analyticsGranularity').value;
            
            try {
                // Load timeline data
                const timelineResponse = await fetch(`/api/rss/metrics?period=${timeRange}&granularity=${granularity}`);
                const timelineData = await timelineResponse.json();
                
                if (timelineData.success && timelineData.data.timeSeries) {
                    updateTimelineChart(timelineData.data.timeSeries);
                }
                
                // Load channel distribution
                const channelsResponse = await fetch('/api/rss/channel-metrics');
                const channelsData = await channelsResponse.json();
                
                if (channelsData.success) {
                    updateDistributionChart(channelsData.data);
                    updateTranslationChart(channelsData.data);
                }
                
                addActivityLog('info', 'Analytics updated');
            } catch (error) {
                console.error('Error updating analytics:', error);
                addActivityLog('error', 'Failed to update analytics');
            }
        }

        function updateTimelineChart(timeSeries) {
            if (!timelineChart) return;
            
            timelineChart.data.labels = timeSeries.labels;
            timelineChart.data.datasets = timeSeries.datasets.map(dataset => ({
                label: dataset.label,
                data: dataset.data,
                borderColor: dataset.borderColor,
                backgroundColor: dataset.backgroundColor,
                tension: 0.4,
                fill: false
            }));
            
            timelineChart.update();
        }

        function updateDistributionChart(channelData) {
            if (!distributionChart) return;
            
            const labels = channelData.map(ch => ch.channel);
            const data = channelData.map(ch => ch.totalItems);
            const colors = channelData.map(ch => ch.color);
            
            distributionChart.data.labels = labels;
            distributionChart.data.datasets[0].data = data;
            distributionChart.data.datasets[0].backgroundColor = colors;
            
            distributionChart.update();
        }

        function updateTranslationChart(channelData) {
            if (!translationChart) return;
            
            const labels = channelData.map(ch => ch.channel);
            const totalData = channelData.map(ch => ch.totalItems);
            const translatedData = channelData.map(ch => ch.translatedItems);
            
            translationChart.data.labels = labels;
            translationChart.data.datasets[0].data = totalData;
            translationChart.data.datasets[1].data = translatedData;
            
            translationChart.update();
        }

        // Health Functions
        async function loadHealthData() {
            try {
                const healthResponse = await fetch('/health');
                const healthData = await healthResponse.json();
                
                if (healthData.status === 'healthy') {
                    const uptimeHours = Math.floor(healthData.uptime / 3600);
                    document.getElementById('healthUptime').textContent = `${uptimeHours}h`;
                    document.getElementById('healthDbResponse').textContent = `${healthData.dbResponseTime || 'N/A'}ms`;
                    document.getElementById('healthMemory').textContent = 'N/A';
                    document.getElementById('healthCpu').textContent = 'N/A';
                }
                
                // Update performance chart with mock data
                updatePerformanceChart();
                
            } catch (error) {
                console.error('Error loading health data:', error);
            }
        }

        function updatePerformanceChart() {
            if (!performanceChart) return;
            
            // Generate mock performance data
            const now = new Date();
            const labels = [];
            const data = [];
            
            for (let i = 23; i >= 0; i--) {
                const time = new Date(now.getTime() - i * 60 * 60 * 1000);
                labels.push(time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }));
                data.push(Math.random() * 100 + 50); // Random response times between 50-150ms
            }
            
            performanceChart.data.labels = labels;
            performanceChart.data.datasets[0].data = data;
            performanceChart.update();
        }

        // Jobs Functions
        async function loadJobsData() {
            try {
                const statsResponse = await fetch('/api/rss/dashboard-stats');
                const statsData = await statsResponse.json();
                
                if (statsData.success) {
                    document.getElementById('rssFetchJobs').textContent = 'Active';
                    document.getElementById('translationJobs').textContent = statsData.data.pendingTranslations || 0;
                    document.getElementById('cleanupJobs').textContent = 'Active';
                    
                    const status = statsData.data.pendingTranslations === 0 ? 'All complete' : 'Processing...';
                    document.getElementById('translationJobsStatus').textContent = status;
                }
            } catch (error) {
                console.error('Error loading jobs data:', error);
            }
        }

        async function triggerRssFetch() {
            try {
                const response = await fetch('/api/rss/refresh', { method: 'POST' });
                const data = await response.json();
                
                if (data.success) {
                    addActivityLog('info', 'RSS fetch triggered manually');
                } else {
                    addActivityLog('error', 'Failed to trigger RSS fetch');
                }
            } catch (error) {
                addActivityLog('error', `RSS fetch failed: ${error.message}`);
            }
        }

        async function triggerTranslation() {
            addActivityLog('info', 'Translation check triggered (feature coming soon)');
        }

        async function triggerCleanup() {
            addActivityLog('info', 'Cleanup job triggered (feature coming soon)');
        }

        // Sessions Functions
        async function loadSessionsData() {
            try {
                // Mock session data until API v2 is fully implemented
                currentSessions = generateMockSessions();
                displaySessions(currentSessions);
            } catch (error) {
                console.error('Error loading sessions data:', error);
            }
        }

        function generateMockSessions() {
            const sessions = [];
            const count = Math.floor(Math.random() * 20) + 5;
            
            for (let i = 0; i < count; i++) {
                const isActive = Math.random() > 0.3;
                const sessionAge = Math.floor(Math.random() * 900); // 0-15 minutes
                const viewedItems = Math.floor(Math.random() * 50);
                
                sessions.push({
                    sessionId: `sess_${Date.now()}_${i}`,
                    isActive,
                    sessionAge,
                    viewedItems,
                    deviceFingerprint: `fp_${Math.random().toString(36).substr(2, 8)}`,
                    createdAt: new Date(Date.now() - sessionAge * 1000)
                });
            }
            
            return sessions;
        }

        function displaySessions(sessions) {
            const container = document.getElementById('sessionsGrid');
            
            if (sessions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <h3>No sessions found</h3>
                        <p>No sessions match your current filters.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = sessions.map(session => `
                <div class="session-card">
                    <div class="session-header">
                        <div class="session-id">${session.sessionId.substring(0, 20)}...</div>
                        <div class="session-status ${session.isActive ? 'active' : 'expired'}">
                            ${session.isActive ? 'Active' : 'Expired'}
                        </div>
                    </div>
                    <div class="session-details">
                        <div class="session-detail">
                            <div class="session-detail-value">${Math.floor(session.sessionAge / 60)}m</div>
                            <div class="session-detail-label">Duration</div>
                        </div>
                        <div class="session-detail">
                            <div class="session-detail-value">${session.viewedItems}</div>
                            <div class="session-detail-label">Items Viewed</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterSessions() {
            const searchTerm = document.getElementById('sessionSearch').value.toLowerCase();
            const statusFilter = document.getElementById('sessionFilter').value;
            
            let filtered = currentSessions.filter(session => {
                const matchesSearch = !searchTerm || 
                    session.sessionId.toLowerCase().includes(searchTerm) ||
                    session.deviceFingerprint.toLowerCase().includes(searchTerm);
                
                let matchesFilter = true;
                if (statusFilter === 'active') {
                    matchesFilter = session.isActive;
                } else if (statusFilter === 'expired') {
                    matchesFilter = !session.isActive;
                }
                
                return matchesSearch && matchesFilter;
            });
            
            displaySessions(filtered);
        }

        async function refreshSessions() {
            await loadSessionsData();
        }

        // Logs Functions
        function loadSystemLogs() {
            // Add some mock system logs
            const logTypes = ['info', 'warning', 'error'];
            const messages = [
                'RSS feed fetched successfully',
                'Translation job completed',
                'Database connection established',
                'Session cleanup completed',
                'Failed to fetch RSS feed',
                'High memory usage detected',
                'API rate limit reached',
                'New session created'
            ];
            
            systemLogs = [];
            for (let i = 0; i < 50; i++) {
                const type = logTypes[Math.floor(Math.random() * logTypes.length)];
                const message = messages[Math.floor(Math.random() * messages.length)];
                const time = new Date(Date.now() - Math.random() * 86400000); // Last 24 hours
                
                systemLogs.push({ time: time.toLocaleTimeString(), type, message, timestamp: time });
            }
            
            systemLogs.sort((a, b) => b.timestamp - a.timestamp);
            displaySystemLogs(systemLogs);
        }

        function displaySystemLogs(logs) {
            const container = document.getElementById('systemLogs');
            
            if (logs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-file-alt"></i>
                        <h3>No logs found</h3>
                        <p>No logs match your current filters.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = logs.map(log => `
                <div class="log-entry">
                    <div class="log-time">${log.time}</div>
                    <div class="log-type ${log.type}">${log.type}</div>
                    <div class="log-message">${log.message}</div>
                </div>
            `).join('');
        }

        function filterLogs() {
            const searchTerm = document.getElementById('logSearch').value.toLowerCase();
            const levelFilter = document.getElementById('logLevelFilter').value;
            
            let filtered = systemLogs.filter(log => {
                const matchesSearch = !searchTerm || 
                    log.message.toLowerCase().includes(searchTerm);
                
                const matchesLevel = levelFilter === 'all' || log.type === levelFilter;
                
                return matchesSearch && matchesLevel;
            });
            
            displaySystemLogs(filtered);
        }

        function exportLogs() {
            const data = systemLogs.map(log => `${log.time} [${log.type.toUpperCase()}] ${log.message}`).join('\n');
            const blob = new Blob([data], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `rss-tok-logs-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            addActivityLog('info', 'System logs exported');
        }

        function clearAllLogs() {
            systemLogs = [];
            displaySystemLogs(systemLogs);
            addActivityLog('info', 'System logs cleared');
        }

        // Utility Functions
        function updateLastUpdateTime() {
            document.getElementById('lastUpdate').textContent = 
                `Updated ${new Date().toLocaleTimeString()}`;
        }

        function addActivityLog(type, message) {
            const time = new Date().toLocaleTimeString();
            activityLog.unshift({ time, type, message });
            
            // Keep only last 100 entries
            if (activityLog.length > 100) {
                activityLog = activityLog.slice(0, 100);
            }
            
            updateActivityLogDisplay();
        }

        function updateActivityLogDisplay() {
            const container = document.getElementById('activityLog');
            
            if (activityLog.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <h3>No activity yet</h3>
                        <p>Activity will appear here as you use the dashboard.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = activityLog.map(entry => `
                <div class="log-entry">
                    <div class="log-time">${entry.time}</div>
                    <div class="log-type ${entry.type}">${entry.type}</div>
                    <div class="log-message">${entry.message}</div>
                </div>
            `).join('');
        }

        function clearLogs() {
            activityLog = [];
            updateActivityLogDisplay();
        }

        function refreshData() {
            const currentView = document.querySelector('.nav-item.active').getAttribute('data-view') || 'dashboard';
            
            if (currentView === 'dashboard') {
                loadDashboard();
            } else {
                loadViewData(currentView);
            }
            
            addActivityLog('info', `${currentView} data refreshed manually`);
        }

        function refreshChannels() {
            loadDashboard();
        }

        async function triggerArticleTranslation(articleId) {
            // This would trigger translation for a specific article
            addActivityLog('info', `Translation triggered for article ${articleId}`);
        }

        function startAutoRefresh() {
            refreshInterval = setInterval(() => {
                loadDashboard();
            }, REFRESH_INTERVAL);
        }

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
        });

        // Handle responsive sidebar
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                document.getElementById('sidebar').classList.remove('open');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) {
                e.preventDefault();
                refreshData();
            }
            
            if (e.ctrlKey && e.shiftKey && e.key === 'T') {
                e.preventDefault();
                toggleTheme();
            }
            
            if (e.key === 'Escape') {
                closeChannelModal();
            }
        });

        // Modal click outside to close
        document.getElementById('channelModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeChannelModal();
            }
        });
    </script>
</body>
</html>